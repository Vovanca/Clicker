<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Football Global Clicker</title>
    <!-- Firebase SDK (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏) -->
    <script src="https://www.gstatic.com"></script>
    <script src="https://www.gstatic.com"></script>
    <style>
        :root { --main: #00ff88; --bg: #0d1117; --card: #161b22; }
        body { background: var(--bg); color: white; font-family: sans-serif; display: flex; margin: 0; height: 100vh; overflow: hidden; }
        
        #shop { width: 300px; background: var(--card); border-right: 1px solid #30363d; padding: 20px; overflow-y: auto; }
        #main { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #leaderboard { width: 280px; background: var(--card); border-left: 1px solid #30363d; padding: 20px; }

        .upg-item { background: #21262d; border: 1px solid #30363d; padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; width: 100%; text-align: left; color: white; }
        .upg-item:hover:not(:disabled) { border-color: var(--main); }
        .upg-item:disabled { opacity: 0.5; cursor: not-allowed; }
        .upg-item b { color: var(--main); font-size: 16px; }

        #ball { width: 200px; height: 200px; border-radius: 50%; background: #fff; font-size: 80px; cursor: pointer; border: none; box-shadow: 0 0 40px rgba(255,255,255,0.1); transition: 0.1s; }
        #ball:active { transform: scale(0.9); }

        .rank { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #30363d; }
        
        #login-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 1000; display: flex; align-items: center; justify-content: center; }
        .modal { background: var(--card); padding: 30px; border-radius: 15px; border: 1px solid var(--main); text-align: center; }
        input { padding: 10px; border-radius: 5px; border: 1px solid #30363d; background: #0d1117; color: white; margin: 10px 0; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="modal">
        <h2>–¢–≤–æ–π –Ω–∏–∫ –¥–ª—è –¢–û–ü–∞:</h2>
        <input type="text" id="nick" maxlength="12"><br>
        <button onclick="saveNick()" style="background:var(--main); border:none; padding:10px 25px; border-radius:5px; cursor:pointer; font-weight:bold;">–í–û–ô–¢–ò –í –ò–ì–†–£</button>
    </div>
</div>

<div id="shop">
    <h3>–£–õ–£–ß–®–ï–ù–ò–Ø</h3>
    <div id="shop-content"></div>
</div>

<div id="main">
    <div id="display-name" style="color:#8b949e">...</div>
    <h1 id="balance" style="font-size:60px; margin:10px; color:var(--main)">0</h1>
    <button id="ball">‚öΩ</button>
    <div style="margin-top:20px;">–ö–ª–∏–∫: +<span id="p-click">1</span> | –ê–≤—Ç–æ: +<span id="p-auto">0</span>/—Å</div>
</div>

<div id="leaderboard">
    <h3>üèÜ –¢–û–ü –ú–ò–†–ê</h3>
    <div id="top-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
</div>

<script>
    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–≤–æ–∏–º –∫–æ–Ω—Ñ–∏–≥–æ–º
    const firebaseConfig = {
        apiKey: "AIzaSyAMDY3BcLQS-HhbolBb1DwyFpYw24-EVhM",
        databaseURL: "https://football-3b1a1-default-rtdb.firebaseio.com",
        projectId: "football-3b1a1",
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 2. –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã (–ø–æ–¥–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
    let state = JSON.parse(localStorage.getItem('fb_clicker')) || {
        name: "",
        money: 0,
        lvls: [0, 0, 0]
    };

    const upgrades = [
        { name: "–ë—É—Ç—Å—ã", base: 15, power: 1, type: 'click' },
        { name: "–¢—Ä–µ–Ω–µ—Ä", base: 100, power: 5, type: 'auto' },
        { name: "–°—Ç–∞–¥–∏–æ–Ω", base: 1000, power: 50, type: 'auto' }
    ];

    function saveNick() {
        const n = document.getElementById('nick').value.trim();
        if(n) {
            state.name = n;
            document.getElementById('login-overlay').style.display = 'none';
            save();
            updateUI();
            pushToCloud();
        }
    }

    if(state.name) document.getElementById('login-overlay').style.display = 'none';

    function save() {
        localStorage.setItem('fb_clicker', JSON.stringify(state));
    }

    function updateUI() {
        document.getElementById('balance').innerText = Math.floor(state.money);
        document.getElementById('display-name').innerText = "–ò–≥—Ä–æ–∫: " + state.name;

        let curClick = 1;
        let curAuto = 0;
        
        const shop = document.getElementById('shop-content');
        shop.innerHTML = "";

        upgrades.forEach((u, i) => {
            let cost = Math.floor(u.base * Math.pow(1.6, state.lvls[i]));
            if(u.type === 'click') curClick += state.lvls[i] * u.power;
            else curAuto += state.lvls[i] * u.power;

            let b = document.createElement('button');
            b.className = "upg-item";
            b.disabled = state.money < cost;
            b.innerHTML = `<b>${u.name}</b> (Lvl ${state.lvls[i]})<br>–¶–µ–Ω–∞: ${cost} ‚öΩ`;
            b.onclick = () => {
                if(state.money >= cost) {
                    state.money -= cost;
                    state.lvls[i]++;
                    save();
                    updateUI();
                }
            };
            shop.appendChild(b);
        });

        document.getElementById('p-click').innerText = curClick;
        document.getElementById('p-auto').innerText = curAuto;
        return { curClick, curAuto };
    }

    document.getElementById('ball').onclick = () => {
        const { curClick } = updateUI();
        state.money += curClick;
        updateUI();
    };

    // 3. –†–∞–±–æ—Ç–∞ —Å –ì–ª–æ–±–∞–ª—å–Ω—ã–º –¢–æ–ø–æ–º
    function pushToCloud() {
        if(!state.name) return;
        db.ref('players/' + state.name).set({
            score: Math.floor(state.money),
            time: Date.now()
        });
    }

    db.ref('players').orderByChild('score').limitToLast(10).on('value', (snap) => {
        const val = snap.val();
        let arr = [];
        for(let id in val) arr.push({name: id, score: val[id].score});
        arr.sort((a,b) => b.score - a.score);
        
        document.getElementById('top-list').innerHTML = arr.map((p, i) => `
            <div class="rank">
                <span>${i+1}. ${p.name}</span>
                <b style="color:var(--main)">${p.score}</b>
            </div>
        `).join('');
    });

    // –¶–∏–∫–ª—ã –∏–≥—Ä—ã
    setInterval(() => {
        const { curAuto } = updateUI();
        if(curAuto > 0) {
            state.money += curAuto / 10;
            updateUI();
        }
    }, 100);

    setInterval(pushToCloud, 10000); // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–∑ –≤ 10 —Å–µ–∫
    updateUI();
</script>
</body>
</html>
